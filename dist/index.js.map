{"version":3,"sources":["../src/index.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import isPlainObject from './isPlainObject'\n\nfunction next (context, calls, index, args) {\n  let item = calls[index]\n  if (index === calls.length - 1) {\n    return item.call(context, ...args)\n  } else {\n    return item.call(context, next.bind(null, context, calls, index + 1), args)\n  }\n}\n\nexport class ArgumentError extends Error {}\n\nexport default function create (...powerups) {\n  if (powerups.length === 0) {\n    throw new ArgumentError('you must provide at least one argument')\n  }\n\n  let calls = []\n  let prototype = {}\n\n  let runner = function (...args) {\n    let context = Object.assign({runner: runner}, prototype)\n    return next(context, calls, 0, args)\n  }\n\n  powerups.forEach((powerup, i) => {\n    if (i === 0 && typeof powerup === 'string') {\n      powerup = {displayName: powerup}\n    }\n\n    let type = typeof powerup\n    let isObject = isPlainObject(powerup)\n\n    if (i === powerups.length - 1) {\n      if (type !== 'function') {\n        throw new ArgumentError('last argument must be a function')\n      }\n    } else if (i === 0) {\n      if (type !== 'function' && !isObject && type !== 'string') {\n        throw new ArgumentError(`argument ${i} must be a function, string, or plain object`)\n      }\n    } else {\n      if (type !== 'function' && !isObject) {\n        throw new ArgumentError(`argument ${i} must be a function or a plain object`)\n      }\n    }\n\n    if (type === 'string') {\n      powerup = {displayName: powerup}\n      type = 'object'\n    }\n\n    if (type === 'function') {\n      calls.push(powerup)\n    }\n\n    if (typeof powerup.prototype === 'object') {\n      Object.assign(prototype, powerup.prototype)\n    }\n\n    Object.keys(powerup)\n      .filter(key => key !== 'prototype')\n      .forEach(key => runner[key] = powerup[key])\n  })\n\n  return runner\n}\n"]}